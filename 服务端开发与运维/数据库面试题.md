> 参考答案请查阅《[Database-Series](https://github.com/wx-chevalier/Database-Series?q=)》

# Database Interview

- 简述 B+Tree 与 LSM Tree 各自的原理，及优劣。

# SQL

- 为什么我们不提倡进行多表 Join 操作？

## SQL 实战

| Name                                                                                                                                          | Problem                                                                                                                                                                                                                                      |
| --------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Reference                                                                                                                                     | [Leetcode SQL problems](https://code.dennyzhang.com/review-sql)                                                                                                                                                                              |
| Use having with group-by                                                                                                                      | `group by class having count(distinct student)>4` [Leecode: Classes More Than 5 Students](https://code.dennyzhang.com/classes-more-than-5-students)                                                                                          |
| Update records with case clause                                                                                                               | `set sex = case when sex = 'm' then 'f' else 'm' end` [LeetCode: Swap Salary](https://code.dennyzhang.com/swap-salary)                                                                                                                       |
| Sum with case                                                                                                                                 | `sum(case when state = 'approved' then 1 else 0 end)` [LeetCode: Monthly Transactions I](https://code.dennyzhang.com/monthly-transactions-i)                                                                                                 |
| Subquery                                                                                                                                      | `where (customer_id, order_date) in (select ...` [LeetCode: Immediate Food Delivery II](https://code.dennyzhang.com/immediate-food-delivery-ii)                                                                                              |
| Sql isnull and if                                                                                                                             | `if(s1.id%2=0, s1.student, if(isnull(s2.student), s1.student, s2.student))`                                                                                                                                                                  |
| round float                                                                                                                                   | `(round(accepts/requests, 2)` [Leecode: Friend Requests I: Overall Acceptance Rate](https://code.dennyzhang.com/friend-requests-i-overall-acceptance-rate)                                                                                   |
| Rank score                                                                                                                                    | (select @rank := 0, @prev := -1) as rows [LeetCode: Rank Scores](https://code.dennyzhang.com/rank-scores)                                                                                                                                    |
| [Select clause add an incremental id](https://stackoverflow.com/questions/15930514/mysql-auto-increment-temporary-column-in-select-statement) | select (@cnt1 := @cnt1 + 1) as id [LeetCode: Students Report By Geography](https://code.dennyzhang.com/students-report-by-geography)                                                                                                         |
| [MySQL DATE_SUB](https://www.w3schools.com/sql/func_mysql_date_sub.asp)                                                                       | `DATE_SUB(record_date, INTERVAL 6 DAY)`                                                                                                                                                                                                      |
| Get accumulated sum for each group                                                                                                            | [LeetCode: Last Person to Fit in the Elevator](https://code.dennyzhang.com/last-person-to-fit-in-the-elevator)                                                                                                                               |
| nth element in each group                                                                                                                     | [LeetCode: Nth Highest Salary](https://code.dennyzhang.com/nth-highest-salary), [LeetCode: Get the Second Most Recent Activity](https://code.dennyzhang.com/get-the-second-most-recent-activity)                                             |
| topn entris for each group                                                                                                                    | [LeetCode: Department Top Three Salaries](https://code.dennyzhang.com/department-top-three-salaries)                                                                                                                                         |
| `union` vs `union all`                                                                                                                        | [LeetCode: Friend Requests II: Who Has the Most Friends](https://code.dennyzhang.com/friend-requests-ii-who-has-the-most-friends)                                                                                                            |
| Convert float to int                                                                                                                          | `cast(amount as SIGNED)`                                                                                                                                                                                                                     |
| If no match show null                                                                                                                         | [LeetCode: Second Highest Salary](https://code.dennyzhang.com/second-highest-salary)                                                                                                                                                         |
| Get maximum of multiple columns                                                                                                               | [LeetCode: Triangle Judgement](https://code.dennyzhang.com/triangle-judgement)                                                                                                                                                               |
| Tree hierachy in SQL                                                                                                                          | [LeetCode: All People Report to the Given Manager](https://code.dennyzhang.com/all-people-report-to-the-given-manager)                                                                                                                       |
| Mysql distinct in having clause                                                                                                               | [LeetCode: Active Users](https://code.dennyzhang.com/active-users)                                                                                                                                                                           |
| mysql doesn’t support full outer join                                                                                                         | [LeetCode: Monthly Transactions II](https://code.dennyzhang.com/monthly-transactions-ii)                                                                                                                                                     |
| When left join+groupby, group by which tables’ field?                                                                                         | [LeetCode: Team Scores in Football Tournament](https://code.dennyzhang.com/team-scores-in-football-tournament)                                                                                                                               |
| `sum(if(isnull(` vs `ifnull(sum(`                                                                                                             | [LeetCode: Team Scores in Football Tournament](https://code.dennyzhang.com/team-scores-in-football-tournament)                                                                                                                               |
| Three tables’ inner join                                                                                                                      | [LeetCode: Students and Examinations](https://code.dennyzhang.com/students-and-examinations)                                                                                                                                                 |
| Find Continuous Ranges                                                                                                                        | [Find the Start and End Number of Continuous Ranges](https://code.dennyzhang.com/find-the-start-and-end-number-of-continuous-ranges)                                                                                                         |
| Impressive sql problems                                                                                                                       | [Leecode: Find Median Given Frequency of Numbers](https://code.dennyzhang.com/find-median-given-frequency-of-numbers), [LeetCode: Consecutive Available Seats](https://code.dennyzhang.com/consecutive-available-seats)                      |
| Impressive sql problems                                                                                                                       | [LeetCode: Rank Scores](https://code.dennyzhang.com/rank-scores), [LeetCode: Exchange Seats](https://code.dennyzhang.com/exchange-seats), [LeetCode: Students Report By Geography](https://code.dennyzhang.com/students-report-by-geography) |

# MySQL

- MySQL 的 utf8 与 utf8mb4 两种格式的区别在哪里？

- 为什么 MySQL 的索引要使用 B+树，而不是其它树？比如 B 树？

- MySQL 中如何处理多时区问题？当 MySQL 为 UTC 时区时，JDBC 中的 serverTimezone 应该如何设置？

- MySQL 自增 ID 用完了怎么办？

- MySQL 中千万级别的大表应该如何优化？

- MySQL 默认隔离级别是RR，为什么阿里这种大厂会改成RC？

# Redis

- 如何用 Redis 统计独立用户访问量？

# 数据库拆分

- 某网络游戏平台的用户 A 在中国, 而用户 B 是他曾经的邻居, 目前在美国。某日，用户 A 将游戏中的道具转给了用户 B，A 在游戏中看到了明确的操作成功的提示，而且刷新也确认道具已经转交。A 在私下用微信告知了这个操作, 然后让 B 在游戏中查看自己的道具背包，但是 B 刷新了一直没发现。这种现象可能因为什么？应该如何去解决？

# Links

- https://quip.com/2gwZArKuWk7W The Best Medium-Hard Data Analyst SQL Interview Questions
